# Artemis Rust é‡å†™å®æ–½è®¡åˆ’

> **For Claude:** REQUIRED SUB-SKILL: Use superpowers:executing-plans to implement this plan task-by-task.

## é¡¹ç›®æ¦‚è¿°

**Goal:** ä½¿ç”¨Rusté‡å†™ArtemisæœåŠ¡æ³¨å†Œä¸­å¿ƒï¼Œæ¶ˆé™¤GCé—®é¢˜ï¼Œå®ç°P99å»¶è¿Ÿ<10msï¼Œæ”¯æŒ100k+å®ä¾‹

**Architecture:** Workspaceå¤šCrateæ¶æ„ï¼ŒåŒ…å«6ä¸ªcrateï¼š
- `artemis-core` - æ ¸å¿ƒæ¨¡å‹å’Œtraitå®šä¹‰
- `artemis-server` - ä¸šåŠ¡é€»è¾‘å®ç°
- `artemis-web` - HTTP/WebSocket APIå±‚
- `artemis-management` - ç®¡ç†åŠŸèƒ½å’ŒæŒä¹…åŒ–
- `artemis-client` - å®¢æˆ·ç«¯SDK
- `artemis` - CLIå·¥å…·å’ŒæœåŠ¡å™¨å¯åŠ¨ç¨‹åº

**Tech Stack:** Rust 2024, Tokio, Axum, DashMap, parking_lot, SQLx, Governor, Serde, Clap

---

## ğŸ“‹ åˆ†é˜¶æ®µå®æ–½è®¡åˆ’

**å®Œæ•´çš„å®æ–½è®¡åˆ’åˆ†ä¸º12ä¸ªé˜¶æ®µï¼Œ52ä¸ªä»»åŠ¡ã€‚**

ğŸ‘‰ **è¯¦ç»†è®¡åˆ’è¯·æŸ¥çœ‹: [phases/README.md](phases/README.md)**

---

## ğŸ¯ å®æ–½è·¯çº¿å›¾

### MVPæ ¸å¿ƒåŠŸèƒ½ï¼ˆP0 å¿…é¡»å®Œæˆï¼‰

**Phase 1-8: åŸºç¡€åŠŸèƒ½** - 37ä¸ªä»»åŠ¡ï¼Œ10-15å°æ—¶

è¿™8ä¸ªé˜¶æ®µæä¾›å®Œæ•´å¯ç”¨çš„æœåŠ¡æ³¨å†Œä¸­å¿ƒï¼š
- âœ… é¡¹ç›®åŸºç¡€è®¾æ–½å’Œæ‰€æœ‰crateåˆå§‹åŒ–
- âœ… æ ¸å¿ƒæ•°æ®æ¨¡å‹ï¼ˆInstance, Service, Leaseç­‰ï¼‰
- âœ… æ³¨å†ŒæœåŠ¡å’Œå‘ç°æœåŠ¡å®Œæ•´å®ç°
- âœ… HTTP APIï¼ˆä¸Javaç‰ˆæœ¬å…¼å®¹ï¼‰
- âœ… ç§Ÿçº¦ç®¡ç†ã€ç‰ˆæœ¬åŒ–ç¼“å­˜ã€é™æµ
- âœ… DiscoveryFilteræœºåˆ¶å’Œå¢é‡å·®å¼‚è®¡ç®—
- âœ… ç®¡ç†åŠŸèƒ½åŸºç¡€å’Œæ•°æ®åº“æŒä¹…åŒ–
- âœ… å®¢æˆ·ç«¯SDKï¼ˆæ³¨å†Œã€å‘ç°ã€è‡ªåŠ¨å¿ƒè·³ï¼‰
- âœ… CLIå·¥å…·ï¼ˆserver/service/instance/configå‘½ä»¤ï¼‰
- âœ… é›†æˆæµ‹è¯•ã€Dockeréƒ¨ç½²ã€PrometheusæŒ‡æ ‡

**å®Œæˆåå¯æŠ•å…¥ç”Ÿäº§ä½¿ç”¨ã€‚**

---

### ç”Ÿäº§å¢å¼ºåŠŸèƒ½ï¼ˆP1 å¼ºçƒˆå»ºè®®ï¼‰

**Phase 9: WebSocketå®æ—¶æ¨é€** - 4ä¸ªä»»åŠ¡ï¼Œ2-3å°æ—¶ ğŸ”¥

å®ç°WebSocketåŠŸèƒ½ï¼Œæ”¯æŒæœåŠ¡å˜æ›´å®æ—¶é€šçŸ¥ï¼š
- SessionManagerä¼šè¯ç®¡ç†
- WebSocket Handlerå’Œè·¯ç”±
- InstanceChangeManagerå˜æ›´æ¨é€
- WebSocketClientå®¢æˆ·ç«¯å®ç°

**Phase 12: æ€§èƒ½ä¼˜åŒ–å’ŒOpenTelemetry** - 5ä¸ªä»»åŠ¡ï¼Œ4-5å°æ—¶ ğŸ”¥

è¾¾åˆ°ç”Ÿäº§çº§æ€§èƒ½æ ‡å‡†ï¼š
- æ·±åº¦æ€§èƒ½åŸºå‡†æµ‹è¯•å’Œä¼˜åŒ–
- çƒ­è·¯å¾„ä¼˜åŒ–ï¼ˆå¿ƒè·³ã€å‘ç°ï¼‰
- OpenTelemetryåˆ†å¸ƒå¼è¿½è¸ªé›†æˆ
- å†…å­˜å’Œå¹¶å‘ä¼˜åŒ–
- éªŒè¯P99 < 10msç›®æ ‡

---

### ä¼ä¸šçº§é«˜çº§åŠŸèƒ½ï¼ˆP2 å¯é€‰ï¼‰

**Phase 10: é›†ç¾¤å’Œæ•°æ®å¤åˆ¶** - 5ä¸ªä»»åŠ¡ï¼Œ4-5å°æ—¶

å¤šèŠ‚ç‚¹é›†ç¾¤å’Œé«˜å¯ç”¨ï¼š
- ClusterManageré›†ç¾¤èŠ‚ç‚¹ç®¡ç†
- ReplicationManageræ•°æ®å¤åˆ¶
- ä¸€è‡´æ€§åè®®
- é›†ç¾¤é…ç½®å’ŒAPI
- é›†ç¾¤æµ‹è¯•

**Phase 11: é«˜çº§ç®¡ç†åŠŸèƒ½** - 4ä¸ªä»»åŠ¡ï¼Œ3-4å°æ—¶

æœåŠ¡åˆ†ç»„å’Œè·¯ç”±è§„åˆ™ï¼š
- GroupManagerå’ŒGroupDao
- RouteManagerå’ŒRouteDao
- GroupDiscoveryFilteråˆ†ç»„è¿‡æ»¤
- ç®¡ç†APIå®Œæ•´å®ç°

---

## ğŸ“Š ç»Ÿè®¡ä¿¡æ¯

| æŒ‡æ ‡ | MVPç‰ˆæœ¬ | å®Œæ•´ç‰ˆæœ¬ |
|------|---------|----------|
| **é˜¶æ®µæ•°** | 8ä¸ª | 12ä¸ª |
| **ä»»åŠ¡æ•°** | 37ä¸ª | 52ä¸ª |
| **é¢„è®¡æ—¶é—´** | 10-15å°æ—¶ | 25-35å°æ—¶ |
| **ä¼˜å…ˆçº§** | P0ï¼ˆå¿…é¡»ï¼‰ | P0-P2 |

---

## ğŸš€ æ‰§è¡ŒæŒ‡å—

### ä½¿ç”¨executing-plansæŠ€èƒ½

```bash
# 1. è¯»å–é˜¶æ®µ1è®¡åˆ’
Read docs/plans/phases/phase1-infrastructure.md

# 2. æ‰§è¡Œé˜¶æ®µ1çš„æ‰€æœ‰Task
# é»˜è®¤æ¯æ‰¹æ‰§è¡Œ3ä¸ªTaskï¼Œå®ŒæˆåæŠ¥å‘Š

# 3. éªŒè¯
cargo check --workspace
cargo test --workspace

# 4. ç»§ç»­ä¸‹ä¸€é˜¶æ®µ
```

### æ‰§è¡Œé¡ºåº

**å¿…é¡»æŒ‰é˜¶æ®µé¡ºåºæ‰§è¡Œ:** Phase 1 â†’ Phase 2 â†’ ... â†’ Phase 12

æ¯ä¸ªé˜¶æ®µä¾èµ–å‰é¢é˜¶æ®µçš„å®Œæˆã€‚

### æ¨èæ‰§è¡Œç­–ç•¥

**ç¬¬ä¸€è½® - MVPç‰ˆæœ¬ï¼ˆ2-3å‘¨ï¼‰:**
- Phase 1-8: æ ¸å¿ƒåŠŸèƒ½
- **äº§å‡º:** å¯ç”¨çš„æœåŠ¡æ³¨å†Œä¸­å¿ƒ

**ç¬¬äºŒè½® - ç”Ÿäº§å¢å¼ºï¼ˆ1å‘¨ï¼‰:**
- Phase 9: WebSocketå®æ—¶æ¨é€
- Phase 12: æ€§èƒ½ä¼˜åŒ–
- **äº§å‡º:** ç”Ÿäº§çº§ç³»ç»Ÿ

**ç¬¬ä¸‰è½® - ä¼ä¸šçº§ï¼ˆæŒ‰éœ€ï¼‰:**
- Phase 10: é›†ç¾¤
- Phase 11: é«˜çº§ç®¡ç†
- **äº§å‡º:** ä¼ä¸šçº§åŠŸèƒ½

---

## ğŸ”— ç›¸å…³æ–‡æ¡£

- **è¯¦ç»†æ‰§è¡ŒæŒ‡å—:** [phases/README.md](phases/README.md) - åŒ…å«æ‰€æœ‰é˜¶æ®µçš„è¯¦ç»†ä¿¡æ¯
- **äº§å“è§„æ ¼è¯´æ˜:** [artemis-rust-rewrite-specification.md](../artemis-rust-rewrite-specification.md)
- **è¯¦ç»†è®¾è®¡æ–‡æ¡£:** [2026-02-13-artemis-rust-design.md](2026-02-13-artemis-rust-design.md)
- **Javaå®ç°å‚è€ƒ:** `../../artemis-java/` (åªè¯»å‚è€ƒ)

---

## ğŸ“ å…³é”®ç‰¹æ€§

### å·²å®Œæ•´è¦†ç›–çš„åŠŸèƒ½

âœ… **æ ¸å¿ƒåŠŸèƒ½**
- æœåŠ¡æ³¨å†Œ/å‘ç°
- ç§Ÿçº¦ç®¡ç†å’Œè‡ªåŠ¨è¿‡æœŸ
- ç‰ˆæœ¬åŒ–ç¼“å­˜å’Œå¢é‡åŒæ­¥
- DiscoveryFilteræœºåˆ¶
- é™æµä¿æŠ¤
- å®ä¾‹æ‹‰å…¥/æ‹‰å‡ºç®¡ç†

âœ… **APIå…¼å®¹æ€§**
- REST APIï¼ˆå…¼å®¹Javaç‰ˆæœ¬.jsonåç¼€ï¼‰
- WebSocketå®æ—¶æ¨é€
- å¤šç§è·¯å¾„æ ¼å¼æ”¯æŒ

âœ… **å®¢æˆ·ç«¯SDK**
- æ³¨å†Œå®¢æˆ·ç«¯ï¼ˆè‡ªåŠ¨å¿ƒè·³ï¼‰
- å‘ç°å®¢æˆ·ç«¯ï¼ˆæœ¬åœ°ç¼“å­˜ï¼‰
- WebSocketå®¢æˆ·ç«¯

âœ… **ç®¡ç†å’Œè¿ç»´**
- CLIå·¥å…·ï¼ˆserver/service/instance/configï¼‰
- é…ç½®è½¬æ¢å·¥å…·ï¼ˆJavaâ†’Rustï¼‰
- MySQLæŒä¹…åŒ–
- ManagementDiscoveryFilter

âœ… **å¯è§‚æµ‹æ€§**
- PrometheusæŒ‡æ ‡
- å¥åº·æ£€æŸ¥
- OpenTelemetryè¿½è¸ªï¼ˆPhase 12ï¼‰

âœ… **éƒ¨ç½²**
- Dockeræ”¯æŒ
- ä¼˜é›…å…³é—­
- ç¯å¢ƒå˜é‡é…ç½®

### é«˜çº§åŠŸèƒ½ï¼ˆPhase 10-11ï¼‰

â­ **é›†ç¾¤åŠŸèƒ½**
- å¤šèŠ‚ç‚¹é›†ç¾¤
- æ•°æ®å¤åˆ¶
- ä¸€è‡´æ€§ä¿è¯

â­ **é«˜çº§ç®¡ç†**
- æœåŠ¡åˆ†ç»„
- è·¯ç”±è§„åˆ™
- æƒé‡è·¯ç”±

---

## âš¡ æ€§èƒ½ç›®æ ‡

| æŒ‡æ ‡ | Javaç‰ˆæœ¬ | Rustç›®æ ‡ | Phase |
|------|----------|----------|-------|
| **P99å»¶è¿Ÿ** | 50-200ms | < 10ms | Phase 12 |
| **QPS** | ~10k | > 100k | Phase 12 |
| **GCåœé¡¿** | 100ms+ | 0ms | å¤©ç„¶æ”¯æŒ |
| **å†…å­˜å ç”¨** | - | -50% | Phase 12 |
| **å®ä¾‹å®¹é‡** | - | 100k+ | Phase 12 |

---

## ğŸ“Œ é‡è¦è¯´æ˜

1. **MVPå®Œæ•´æ€§:** Phase 1-8æä¾›å®Œæ•´å¯ç”¨çš„æ ¸å¿ƒåŠŸèƒ½ï¼Œå¯ç›´æ¥æŠ•å…¥ç”Ÿäº§
2. **ç”Ÿäº§å»ºè®®:** å¼ºçƒˆå»ºè®®åœ¨ç”Ÿäº§éƒ¨ç½²å‰å®ŒæˆPhase 9å’ŒPhase 12
3. **çµæ´»æ€§:** Phase 10-11å¯æ ¹æ®å®é™…ä¸šåŠ¡éœ€æ±‚é€‰æ‹©æ€§å®ç°
4. **å‚è€ƒå®ç°:** æ‰€æœ‰è®¾è®¡éƒ½å‚è€ƒäº†Javaç‰ˆæœ¬ï¼Œç¡®ä¿åŠŸèƒ½å¯¹ç­‰
5. **æµ‹è¯•è¦†ç›–:** æ¯ä¸ªPhaseéƒ½åŒ…å«å®Œæ•´çš„æµ‹è¯•è¦æ±‚

---

## ğŸ¯ å¼€å§‹å®æ–½

å‡†å¤‡å¥½åï¼Œè¯·ä½¿ç”¨ `superpowers:executing-plans` æŠ€èƒ½å¼€å§‹æ‰§è¡Œï¼š

```
è¯»å– docs/plans/phases/phase1-infrastructure.md å¼€å§‹Phase 1
```

æ‰€æœ‰é˜¶æ®µçš„è¯¦ç»†ä»»åŠ¡ã€ä»£ç ç¤ºä¾‹ã€éªŒè¯æ­¥éª¤éƒ½åœ¨ `phases/` ç›®å½•ä¸­ã€‚
